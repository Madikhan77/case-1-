# Vehicle Damage Classification (8 Classes)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º.  
–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ VIA (VGG Image Annotator) –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **8 –∫–ª–∞—Å—Å–æ–≤**:

1. `dent` ‚Äì –≤–º—è—Ç–∏–Ω—ã / –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –∫—É–∑–æ–≤–∞  
2. `scratch` ‚Äì —Ü–∞—Ä–∞–ø–∏–Ω—ã, –∫—Ä–∞—Å–∫–∞  
3. `broken glass` ‚Äì —Ä–∞–∑–±–∏—Ç—ã–µ —Å—Ç—ë–∫–ª–∞  
4. `lost parts` ‚Äì –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏  
5. `punctured` ‚Äì –ø—Ä–æ–±–æ–∏–Ω—ã  
6. `torn` ‚Äì —Ä–∞–∑—Ä—ã–≤—ã  
7. `broken lights` ‚Äì –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ —Ñ–∞—Ä—ã/—Ñ–æ–Ω–∞—Ä–∏  
8. `non-damage` ‚Äì –±–µ–∑ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ —Ä–µ–≥–∏–æ–Ω–æ–≤)  

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞


dataset/
‚îú‚îÄ‚îÄ image/
‚îÇ ‚îî‚îÄ‚îÄ image/ # train –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ validation/
‚îÇ ‚îî‚îÄ‚îÄ validation/ # validation –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
0Train_via_annos.json # –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è train
0Val_via_annos.json # –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è validation
train_history.json # –∏—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)
vehide_cls8_resnet50_best.pt # –ª—É—á—à–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç –º–æ–¥–µ–ª–∏
vehide_cls8_resnet50_last.pt # –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç –º–æ–¥–µ–ª–∏




---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

- `main()` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞. –ó–∞–ø—É—Å–∫–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ (warmup + fine-tune), —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é, –æ—Ç—á—ë—Ç—ã –∏ —á–µ–∫–ø–æ–∏–Ω—Ç—ã.
- **–ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–∑–º–µ—Ç–∫–∏**  
  - `extract_raw_label_from_region` ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—ã—Ä—É—é –º–µ—Ç–∫—É –∏–∑ region.  
  - `raw_to_final` ‚Äî –º–∞–ø–ø–∏–Ω–≥ —Å—ã—Ä–æ–π –º–µ—Ç–∫–∏ (rach, tray_son, vo_kinh –∏ –¥—Ä.) –≤ –æ–¥–∏–Ω –∏–∑ 8 —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤.  
  - `aggregate_regions_to_final_label` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —Ä–µ–≥–∏–æ–Ω—ã –≤ –æ–¥–Ω–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é (weighted majority vote).
- **–î–∞—Ç–∞—Å–µ—Ç—ã –∏ DataLoader**  
  - `VehicleDamageDataset` ‚Äî –∫–ª–∞—Å—Å PyTorch Dataset.  
  - `get_transforms` ‚Äî –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è train/val.  
- **–ú–æ–¥–µ–ª—å**  
  - `VehicleDamageModel` ‚Äî ResNet50 (–∏–ª–∏ EfficientNet).  
  - –ú–µ—Ç–æ–¥—ã `freeze_backbone` –∏ `unfreeze_backbone` ‚Äî –¥–ª—è —Ñ–∞–∑ warmup/finetune.  
- **–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞**  
  - `train_epoch` –∏ `validate_epoch` ‚Äî –æ–±—É—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞ —ç–ø–æ—Ö—É.  
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `CrossEntropyLoss` —Å –≤–µ—Å–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤.  
  - `AdamW` –∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä.  
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**  
  - –õ–æ–≥–∏—Ä—É—é—Ç—Å—è accuracy, F1, precision, recall, balanced accuracy.  
  - `plot_confusion` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç confusion matrix.  
  - –í –∫–æ–Ω—Ü–µ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è `classification_report` –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º.

---

## ‚öôÔ∏è –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- `IMG_SIZE = 448` ‚Äî —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.  
- `BATCH_SIZE = 8`  
- `EPOCHS = 7` (3 warmup + 4 finetune)  
- `BASE_LR = 3e-4` ‚Äî learning rate –¥–ª—è warmup.  
- `FINETUNE_LR = 1e-4` ‚Äî learning rate –¥–ª—è fine-tune.  
- `WEIGHT_DECAY = 1e-4`  
- `MODEL_NAME = "resnet50"`  

---

## üîß –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install torch torchvision scikit-learn matplotlib seaborn tqdm pillow
