Vehicle Damage Classification (8 Classes)

–ú–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ç–∏–ø –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–æ —Ñ–æ—Ç–æ.
–†–∞–∑–º–µ—Ç–∫–∞ ‚Äî VIA (VGG Image Annotator). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–ª–∞—Å—Å—ã:

dent ‚Äî –≤–º—è—Ç–∏–Ω—ã / –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏—è –∫—É–∑–æ–≤–∞

scratch ‚Äî —Ü–∞—Ä–∞–ø–∏–Ω—ã / –ø–æ–∫—Ä–∞—Å–∫–∞

broken glass ‚Äî —Ç—Ä–µ—Å–Ω—É–≤—à–∏–µ/—Ä–∞–∑–±–∏—Ç—ã–µ —Å—Ç—ë–∫–ª–∞

lost parts ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–µ—Ç–∞–ª–∏

punctured ‚Äî –ø—Ä–æ–∫–æ–ª—ã/–ø—Ä–æ–±–æ–∏–Ω—ã

torn ‚Äî —Ä–∞–∑—Ä—ã–≤—ã

broken lights ‚Äî –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ —Ñ–∞—Ä—ã/—Ñ–æ–Ω–∞—Ä–∏

non-damage ‚Äî –±–µ–∑ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π (–∫–æ–≥–¥–∞ regions –ø—É—Å—Ç–æ–π)

üì¶ –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
dataset/
‚îú‚îÄ image/
‚îÇ  ‚îî‚îÄ image/             # train –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îú‚îÄ validation/
‚îÇ  ‚îî‚îÄ validation/        # validation –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
0Train_via_annos.json    # –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (train, —Ñ–æ—Ä–º–∞—Ç VIA)
0Val_via_annos.json      # –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (val, —Ñ–æ—Ä–º–∞—Ç VIA)
train_history.json       # –∏—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è (—Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)
vehide_cls8_resnet50_best.pt  # –ª—É—á—à–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç (—Å–∫–∞—á–∞—Ç—å, —Å–º. –Ω–∏–∂–µ)
vehide_cls8_resnet50_last.pt  # –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
app_streamlit.py         # –≤–µ–±-–¥–µ–º–æ –Ω–∞ Streamlit
presentation.html        # —Å–ª–∞–π–¥—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
train.py / main.py       # –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏


–ï—Å–ª–∏ –∫–∞–∫–∏—Ö-—Ç–æ —Ñ–∞–π–ª–æ–≤ –Ω–µ—Ç ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ: –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –∏—Ö –Ω—É–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å (—Å–º. —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª).

‚òÅÔ∏è –ì–¥–µ –≤–∑—è—Ç—å –≤–µ—Åa –º–æ–¥–µ–ª–∏

–û–±—É—á–µ–Ω–Ω—ã–π —á–µ–∫–ø–æ–∏–Ω—Ç vehide_cls8_resnet50_best.pt –ª–µ–∂–∏—Ç —É —Ç–µ–±—è –Ω–∞ Google Drive.
–°–∫–∞—á–∞–π –µ–≥–æ –∏ –ø–æ–ª–æ–∂–∏ —Ä—è–¥–æ–º —Å –∫–æ–¥–æ–º (–≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞).

–°—Å—ã–ª–∫–∞ –Ω–∞ Google Drive: (–≤—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª)
(–ú—ã –Ω–µ –ø—É–±–ª–∏–∫—É–µ–º —Å—Å—ã–ª–∫—É –∑–¥–µ—Å—å, –Ω–æ –∫–æ–º–∞–Ω–¥–∞ –∑–Ω–∞–µ—Ç –µ—ë. –ë–µ–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ Streamlit-–¥–µ–º–æ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.)

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:

.
‚îú‚îÄ app_streamlit.py
‚îú‚îÄ presentation.html
‚îú‚îÄ vehide_cls8_resnet50_best.pt  # <-- –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
‚îî‚îÄ ...

‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

Python 3.10‚Äì3.11 —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è.

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

pip install -U pip
pip install torch torchvision numpy pillow scikit-learn matplotlib seaborn tqdm streamlit


(–∏–ª–∏ –ø–æ–ª–æ–∂–∏ –Ω–∞—à –∫–æ—Ä–æ—Ç–∫–∏–π requirements.txt –∏ –≤—ã–ø–æ–ª–Ω–∏ pip install -r requirements.txt)

üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Streamlit –¥–µ–º–æ)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

streamlit run app_streamlit.py


–û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä: http://localhost:8501

–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ ‚Üí –ø–æ–ª—É—á–∏—Ç–µ –∫–ª–∞—Å—Å + –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ –≤—Å–µ–º 8 –∫–ª–∞—Å—Å–∞–º.

–ï—Å–ª–∏ —É —Ç–µ–±—è OneDrive/–ø—É—Ç—å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏/—Å–∏–º–≤–æ–ª–∞–º–∏ —Ç–∏–ø–∞ & ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ; –∫–æ–º–∞–Ω–¥—É streamlit run –∑–∞–ø—É—Å–∫–∞–π –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞.

üñºÔ∏è –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è (—Å–ª–∞–π–¥—ã)

–ì–æ—Ç–æ–≤—ã–π HTML-—Ñ–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º –¥–∞—Ç–∞—Å–µ—Ç–∞:

–û—Ç–∫—Ä–æ–π presentation.html –¥–≤–æ–π–Ω—ã–º –∫–ª–∏–∫–æ–º.

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–∞–π–¥–æ–≤ ‚Äî –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–ù–∞–∑–∞–¥/–í–ø–µ—Ä—ë–¥¬ª –∏–ª–∏ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ ‚Üê/‚Üí.

–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–ø–æ—Å–ª–µ 7 —ç–ø–æ—Ö):

Train Acc: 70.52%

Val Acc: 67.60%

Macro F1: 0.417

Macro Precision: 0.390

Macro Recall: 0.471

Balanced Acc: 0.754

–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–ª–∞—Å—å –≤—Å–µ–≥–æ 7 —ç–ø–æ—Ö (3 warmup + 4 finetune). –ë–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ —ç–ø–æ—Ö, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –æ–±—ã—á–Ω–æ —É–ª—É—á—à–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏.

üß† –û–±—É—á–µ–Ω–∏–µ (–µ—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å)

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

IMG_SIZE=448, BATCH_SIZE=8

EPOCHS=7 (3 warmup + 4 finetune)

BASE_LR=3e-4, FINETUNE_LR=1e-4

–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: AdamW

–õ–æ—Å—Å: CrossEntropyLoss —Å –≤–µ—Å–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤ (–ø–æ –æ–±—Ä–∞—Ç–Ω–æ–π —á–∞—Å—Ç–æ—Ç–µ)

–ó–∞–ø—É—Å–∫ (–ø—Ä–∏–º–µ—Ä):

python train.py


–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è/–æ–±–Ω–æ–≤—è—Ç—Å—è:

vehide_cls8_resnet50_best.pt

vehide_cls8_resnet50_last.pt

train_history.json

confusion_matrix.png

–ø–æ–¥—Ä–æ–±–Ω—ã–π classification_report –≤ –∫–æ–Ω—Å–æ–ª–∏

üßæ –ü—Ä–æ –¥–∞—Ç–∞—Å–µ—Ç

–§–æ—Ä–º–∞—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π: VIA (VGG Image Annotator) ‚Äî —Å–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –º–∞—Å—Å–∏–≤–æ–º regions, —É –∫–∞–∂–¥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –µ—Å—Ç—å class/label –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –≤ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è—Ö –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤—å–µ—Ç–Ω–∞–º—Å–∫–∏–µ —Ç–µ–≥–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, rach, mop_lom, vo_kinh), –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–∞–ø–ø–∏–º –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ 8 –∫–ª–∞—Å—Å–æ–≤:

rach, paint, paint_damage, tray_son ‚Üí scratch

mop_lom, body_damage, door_dent, bumper_dent, thung ‚Üí dent

vo_kinh, broken_glass, glass_shatter ‚Üí broken glass

mat_bo_phan ‚Üí lost parts

broken_lights, headlight_damage, tail_lamp_broken, be_den ‚Üí broken lights

punctured ‚Üí punctured

torn ‚Üí torn

regions == [] ‚Üí non-damage

–í —Ç–µ–∫—É—â–∏—Ö JSON —á–∞—Å—Ç–æ –Ω–µ—Ç –ø—É—Å—Ç—ã—Ö regions, –ø–æ—ç—Ç–æ–º—É non-damage –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –æ–±—É—á–µ–Ω–∏–∏. –î–æ–±–∞–≤—å —á–∏—Å—Ç—ã–µ —Å–Ω–∏–º–∫–∏ –±–µ–∑ —Ä–∞–∑–º–µ—Ç–∫–∏ (–∏–ª–∏ —Å–æ–±–µ—Ä–∏ –∫–∞–¥—Ä—ã —Å regions: []), —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –Ω–∞—É—á–∏–ª–∞—Å—å –∫–ª–∞—Å—Å—É non-damage.

–î–∏—Å–±–∞–ª–∞–Ω—Å: –º–Ω–æ–≥–æ scratch/dent, –º–∞–ª–æ broken lights, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç punctured/torn/non-damage. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç Macro F1; –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤, –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî WeightedRandomSampler/oversampling.

üîç –ò–Ω—Ñ–µ—Ä–µ–Ω—Å (—Å–∫—Ä–∏–ø—Ç–æ–º)

–ú–∏–Ω–∏-–ø—Ä–∏–º–µ—Ä (–æ–¥–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞, –∫–∞–∫ –≤ test_one_image.py):

import torch
from PIL import Image
from torchvision import transforms

from model import VehicleDamageModel, FINAL_CLASSES  # —Ç–≤–æ–π –º–æ–¥—É–ª—å

DEVICE = "cuda" if torch.cuda.is_available() else "cpu"
IMG_SIZE = 448
TF = transforms.Compose([
    transforms.Resize((IMG_SIZE, IMG_SIZE)),
    transforms.ToTensor(),
    transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225]),
])

model = VehicleDamageModel(num_classes=len(FINAL_CLASSES), model_name="resnet50").to(DEVICE)
ckpt = torch.load("vehide_cls8_resnet50_best.pt", map_location=DEVICE)
model.load_state_dict(ckpt.get("model_state_dict", ckpt))
model.eval()

img = Image.open("test.jpg").convert("RGB")
x = TF(img).unsqueeze(0).to(DEVICE)

with torch.no_grad():
    out = model(x)
    probs = torch.softmax(out, dim=1)[0].cpu().numpy()
    pred = FINAL_CLASSES[int(probs.argmax())]

print("Prediction:", pred)

üõ†Ô∏è –¢—Ä—É–¥–Ω–æ—Å—Ç–∏ –∏ –∫–∞–∫ –∏—Ö –æ–±–æ–π—Ç–∏

–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ ‚Üí –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤, oversampling, —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤.

–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ non-damage ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —Å–Ω–∏–º–∫–∏ –±–µ–∑ —Ä–∞–∑–º–µ—Ç–∫–∏ (regions: []).

–ü–æ—Ö–æ–∂–∏–µ –∫–ª–∞—Å—Å—ã –ø—É—Ç–∞—é—Ç—Å—è (dent vs punctured) ‚Üí –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤, –±–æ–ª–µ–µ —á—ë—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑–º–µ—Ç–∫–∏.

–ú–∞–ª–æ —ç–ø–æ—Ö (7) ‚Üí —É–≤–µ–ª–∏—á–∏—Ç—å EPOCHS, –¥–æ–±–∞–≤–∏—Ç—å early-stopping/ReduceLROnPlateau.

üß© –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

PowerShell: ‚Äú–ê–º–ø–µ—Ä—Å–∞–Ω–¥ (&) –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω‚Ä¶‚Äù
–ü—É—Ç—å —Å–æ–¥–µ—Ä–∂–∏—Ç &. –õ–∏–±–æ –≤–æ–∑—å–º–∏ –ø—É—Ç—å –≤ –∫–∞–≤—ã—á–∫–∏, –ª–∏–±–æ –∑–∞–ø—É—Å–∫–∞–π –∫–æ–º–∞–Ω–¥—ã –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:

cd "C:\Users\...\InDrive"
streamlit run app_streamlit.py


Uvicorn –Ω–µ –Ω—É–∂–µ–Ω (–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Streamlit). –ï—Å–ª–∏ —Ä–µ—à–∏—à—å –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ API ‚Äî –ª—É—á—à–µ –¥–µ—Ä–∂–∞—Ç—å FastAPI –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ.

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

–†–∞–∑–º–µ—Ç–∫–∞ VIA –æ–±—ã—á–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∫–æ–º–∞–Ω–¥–∞–º–∏ –∞–Ω–Ω–æ—Ç–∞—Ç–æ—Ä–æ–≤.

–°—É–¥—è –ø–æ —Ç–µ–≥–∞–º (rach, mop_lom, vo_kinh), –¥–∞—Ç–∞—Å–µ—Ç —Å–æ–±–∏—Ä–∞–ª—Å—è –≤–æ –í—å–µ—Ç–Ω–∞–º–µ (—Å—Ç—Ä–∞—Ö–æ–≤—ã–µ/–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã).

–ï—Å–ª–∏ –ø—É–±–ª–∏–∫—É–µ—à—å –∫–æ–¥ –∏ –≤–µ—Å–∞ –ø—É–±–ª–∏—á–Ω–æ ‚Äî –¥–æ–±–∞–≤—å –ª–∏—Ü–µ–Ω–∑–∏—é –∏ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—è–º/–∏—Å—Ç–æ—á–Ω–∏–∫—É.
